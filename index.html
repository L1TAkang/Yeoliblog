<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yeoli Blog</title>
    
    <!-- Tailwind CSS CDN 불러오기 -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Pretendard 폰트 CDN 불러오기 -->
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />

    <!-- Noto Serif KR 폰트 (Google Fonts) 불러오기 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* 기본 폰트 및 스타일 */
        body { font-family: 'Pretendard', sans-serif; }
        .font-noto-serif { font-family: 'Noto Serif KR', serif; }

        /* 스크롤바 숨기기 (왼쪽 패널) */
        aside::-webkit-scrollbar { display: none; }
        aside { -ms-overflow-style: none; scrollbar-width: none; }

        /* 스크롤바 디자인 (오른쪽 패널) */
        main::-webkit-scrollbar { width: 5px; }
        main::-webkit-scrollbar-track { background: transparent; }
        main::-webkit-scrollbar-thumb { background: #e5e7eb; border-radius: 3px; }
        main::-webkit-scrollbar-thumb:hover { background: #d1d5db; }

        /* 편집기 내용 영역 스타일 */
        .editor-content:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }
        
        /* 모바일 메뉴 슬라이드 애니메이션 */
        #aside-menu {
            transition: transform 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-white text-gray-800 overflow-hidden">

    <!-- 1. 헤더 -->
    <header class="fixed top-0 left-0 w-full h-16 bg-black flex items-center justify-between px-4 md:px-6 z-20">
        <div class="flex items-center">
            <!-- 모바일용 햄버거 메뉴 버튼 -->
            <button id="mobile-menu-btn" class="text-white mr-4 md:hidden">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
            </button>
            <h1 class="text-2xl md:text-3xl font-bold text-white tracking-wider font-noto-serif">Yeoli Blog</h1>
        </div>
        <button id="open-editor-btn" class="text-white hover:text-gray-300 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
            </svg>
        </button>
    </header>
    
    <!-- 모바일 메뉴 오버레이 -->
    <div id="mobile-menu-overlay" class="hidden fixed inset-0 bg-black/50 z-30 md:hidden"></div>

    <!-- 2. 메인 컨테이너 -->
    <div id="main-container" class="flex pt-16 h-screen">
        <!-- JavaScript로 동적 생성됩니다. -->
    </div>

    <!-- 3. 비밀번호 입력 모달 -->
    <div id="password-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg p-8 shadow-xl w-full max-w-sm">
            <h2 class="text-lg font-bold mb-4">관리자 로그인</h2>
            <form id="password-form">
                <label for="password-input" class="block text-sm font-medium text-gray-700">비밀번호를 입력하세요</label>
                <input type="password" id="password-input" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-black focus:border-black sm:text-sm">
                <div class="mt-4 flex justify-end space-x-2">
                    <button type="button" id="password-cancel" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">취소</button>
                    <button type="submit" class="px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800">확인</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 4. 게시물 편집기 모달 -->
    <div id="editor-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-6xl h-[90vh] flex flex-col">
            <div class="p-4 border-b flex justify-between items-center">
                <h2 class="text-xl font-bold">게시물 편집기</h2>
                <button id="editor-close-btn" class="text-gray-500 hover:text-gray-800 text-2xl leading-none">&times;</button>
            </div>
            <div class="flex-grow flex flex-col md:flex-row min-h-0">
                <div class="w-full md:w-1/3 lg:w-1/4 border-b md:border-b-0 md:border-r flex flex-col bg-gray-50">
                    <div id="editor-post-list" class="flex-grow overflow-y-auto p-4"></div>
                    <div class="p-4 border-t">
                        <button id="add-new-post-btn" class="w-full flex items-center justify-center px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" /></svg>
                            새 게시물 추가
                        </button>
                    </div>
                </div>
                <div class="w-full md:w-2/3 lg:w-3/4 flex flex-col p-4 overflow-y-auto">
                    <div class="mb-4">
                        <label for="editor-title" class="block text-sm font-medium text-gray-700">제목</label>
                        <input type="text" id="editor-title" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                    </div>
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4">
                        <div class="mb-4 sm:mb-0">
                            <label for="editor-date" class="block text-sm font-medium text-gray-700">발행일</label>
                            <input type="date" id="editor-date" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                        </div>
                        <div class="flex items-center pt-6">
                            <input id="editor-pin-toggle" type="checkbox" class="h-4 w-4 text-black border-gray-300 rounded focus:ring-black">
                            <label for="editor-pin-toggle" class="ml-2 block text-sm font-medium text-gray-900">게시물 고정</label>
                        </div>
                    </div>
                    <div class="mb-4 flex-grow flex flex-col">
                        <label class="block text-sm font-medium text-gray-700 mb-1">내용</label>
                        <div id="editor-content" contenteditable="true" class="flex-grow border border-gray-300 rounded-md p-2 overflow-y-auto editor-content"></div>
                    </div>
                    <div class="flex flex-col sm:flex-row justify-between items-center">
                        <button id="editor-delete-btn" class="w-full sm:w-auto px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed mb-2 sm:mb-0">삭제</button>
                        <div class="space-x-2">
                            <button id="editor-cancel-btn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">취소</button>
                            <button id="editor-save-btn" class="px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800">저장</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 5. 커스텀 알림창 -->
    <div id="custom-alert" class="hidden fixed top-5 right-5 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50">
        <p id="custom-alert-message"></p>
    </div>

    <!-- 6. 삭제 확인 모달 -->
    <div id="delete-confirm-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg p-8 shadow-xl w-full max-w-sm">
            <h2 class="text-lg font-bold mb-2">게시물 삭제</h2>
            <p id="delete-confirm-message" class="text-gray-600 mb-6"></p>
            <div class="flex justify-end space-x-2">
                <button type="button" id="delete-cancel-btn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">취소</button>
                <button type="button" id="delete-confirm-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">삭제</button>
            </div>
        </div>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- 데이터 관리 ---
        let posts = [
            { id: 1, title: "새로운 시작, 코딩 첫걸음", date: "2025-08-12", content: `<p>코딩의 세계에 오신 것을 환영합니다. 이 공간은 당신의 아이디어가 현실이 되는 곳입니다. 처음에는 모든 것이 낯설고 복잡하게 느껴질 수 있지만, 한 걸음씩 나아가다 보면 어느새 멋진 결과물을 만들어내는 자신을 발견하게 될 것입니다.</p><figure><img src="https://placehold.co/800x400/e2e8f0/334155?text=Code+Snippet" alt="Code Snippet Placeholder" class="rounded-lg shadow-md my-4"><figcaption class="text-center text-sm text-gray-500 mt-2">이곳에 이미지나 코드 블록을 넣을 수 있습니다.</figcaption></figure><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p><blockquote class="border-l-4 border-gray-900 pl-4 italic text-gray-600 my-4">"The only way to do great work is to love what you do." - Steve Jobs</blockquote>`, isPinned: true },
            { id: 2, title: "CSS 레이아웃의 모든 것", date: "2025-08-10", content: `<p>CSS 레이아웃은 웹 디자인의 뼈대를 만드는 중요한 기술입니다. Flexbox와 Grid에 대해 알아봅시다.</p>`, isPinned: false },
            { id: 3, title: "JavaScript 비동기 처리 이해하기", date: "2025-08-08", content: `<p>Promise와 async/await를 사용하여 JavaScript의 비동기 코드를 깔끔하게 작성하는 방법을 배웁니다.</p>`, isPinned: false }
        ];
        let currentEditingPostId = null;
        let isCreatingNewPost = false;

        // --- DOM 요소 ---
        const mainContainer = document.getElementById('main-container');
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
        const openEditorBtn = document.getElementById('open-editor-btn');
        const passwordModal = document.getElementById('password-modal');
        const passwordForm = document.getElementById('password-form');
        const passwordInput = document.getElementById('password-input');
        const passwordCancelBtn = document.getElementById('password-cancel');
        const editorModal = document.getElementById('editor-modal');
        const editorPostList = document.getElementById('editor-post-list');
        const editorTitle = document.getElementById('editor-title');
        const editorDate = document.getElementById('editor-date');
        const editorPinToggle = document.getElementById('editor-pin-toggle');
        const editorContent = document.getElementById('editor-content');
        const editorSaveBtn = document.getElementById('editor-save-btn');
        const editorDeleteBtn = document.getElementById('editor-delete-btn');
        const editorCloseBtn = document.getElementById('editor-close-btn');
        const editorCancelBtn = document.getElementById('editor-cancel-btn');
        const addNewPostBtn = document.getElementById('add-new-post-btn');
        const customAlert = document.getElementById('custom-alert');
        const customAlertMessage = document.getElementById('custom-alert-message');
        const deleteConfirmModal = document.getElementById('delete-confirm-modal');
        const deleteConfirmMessage = document.getElementById('delete-confirm-message');
        const deleteConfirmBtn = document.getElementById('delete-confirm-btn');
        const deleteCancelBtn = document.getElementById('delete-cancel-btn');

        // --- 렌더링 함수 ---
        function renderBlog() {
            mainContainer.innerHTML = '';
            
            // 왼쪽 패널 (Aside) 생성
            const aside = document.createElement('aside');
            aside.id = 'aside-menu';
            // 모바일: 숨김, 태블릿: 1/3 너비, 데스크톱: 고정 너비(384px)
            aside.className = "fixed top-0 left-0 w-4/5 max-w-sm md:w-1/3 lg:w-96 bg-gray-50 h-full overflow-y-auto p-6 transform -translate-x-full md:relative md:translate-x-0 md:h-auto z-40 flex-shrink-0";
            
            const ul = document.createElement('ul');
            ul.className = 'space-y-1';

            const sortedPosts = [...posts].sort((a, b) => b.isPinned - a.isPinned);

            if (sortedPosts.length > 0) {
                sortedPosts.forEach(post => {
                    const li = document.createElement('li');
                    const pinIconHTML = post.isPinned ? `<div class="w-5 text-center mr-2 flex-shrink-0 text-gray-400">📌</div>` : '<div class="w-5 mr-2 flex-shrink-0"></div>';
                    li.innerHTML = `<a href="#post-${post.id}" data-id="${post.id}" class="post-link flex items-center p-3 rounded-lg hover:bg-white hover:shadow-sm transition-all">${pinIconHTML}<span class="flex-1 truncate">${post.title}</span></a>`;
                    ul.appendChild(li);
                });
            }
            
            aside.appendChild(ul);

            // 오른쪽 패널 (Main) 생성
            const main = document.createElement('main');
            // 남은 공간을 모두 차지하도록 flex-grow 사용
            main.className = "w-full md:flex-grow h-full overflow-y-auto p-8 md:p-12";
            main.innerHTML = `<div id="post-content-wrapper"></div>`;
            
            mainContainer.appendChild(aside);
            mainContainer.appendChild(main);

            const firstPostToShow = sortedPosts[0];
            if (firstPostToShow) {
                renderPostContent(firstPostToShow.id);
                highlightActiveLink(firstPostToShow.id);
            } else {
                document.getElementById('post-content-wrapper').innerHTML = `<div class="text-center text-gray-500">게시물이 없습니다.</div>`;
            }
        }

        function renderPostContent(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;
            const wrapper = document.getElementById('post-content-wrapper');
            if(wrapper) {
                wrapper.innerHTML = `<article class="max-w-3xl mx-auto"><h3 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">${post.title}</h3><p class="text-gray-500 mb-8">${new Date(post.date).toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric' })}</p><div class="space-y-6 text-lg leading-relaxed text-gray-700">${post.content}</div></article>`;
            }
        }
        
        function highlightActiveLink(postId) {
            document.querySelectorAll('.post-link').forEach(link => {
                const isMatch = parseInt(link.dataset.id) === postId;
                link.classList.toggle('bg-white', isMatch);
                link.classList.toggle('font-semibold', isMatch);
                link.classList.toggle('text-gray-900', isMatch);
                link.classList.toggle('shadow-sm', isMatch);
            });
        }

        // --- 이벤트 핸들러 ---
        mainContainer.addEventListener('click', (e) => {
            if (e.target.closest('.post-link')) {
                e.preventDefault();
                const link = e.target.closest('.post-link');
                const postId = parseInt(link.dataset.id);
                renderPostContent(postId);
                highlightActiveLink(postId);
                // 모바일에서 링크 클릭 시 메뉴 닫기
                if (window.innerWidth < 768) {
                    toggleMobileMenu(false);
                }
            }
        });

        function showAlert(message, isError = false) {
            customAlertMessage.textContent = message;
            customAlert.classList.toggle('bg-red-500', isError);
            customAlert.classList.toggle('bg-green-500', !isError);
            customAlert.classList.remove('hidden');
            setTimeout(() => customAlert.classList.add('hidden'), 3000);
        }
        
        // 모바일 메뉴 토글
        function toggleMobileMenu(show) {
            const asideMenu = document.getElementById('aside-menu');
            if (show) {
                mobileMenuOverlay.classList.remove('hidden');
                asideMenu.classList.remove('-translate-x-full');
            } else {
                mobileMenuOverlay.classList.add('hidden');
                asideMenu.classList.add('-translate-x-full');
            }
        }
        mobileMenuBtn.addEventListener('click', () => toggleMobileMenu(true));
        mobileMenuOverlay.addEventListener('click', () => toggleMobileMenu(false));

        openEditorBtn.addEventListener('click', () => {
            passwordModal.classList.remove('hidden');
            passwordInput.focus();
        });

        function closePasswordModal() {
            passwordModal.classList.add('hidden');
            passwordForm.reset();
        }
        passwordCancelBtn.addEventListener('click', closePasswordModal);

        passwordForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const correctPasswordHash = "MTIzMQ==";
            if (btoa(passwordInput.value) === correctPasswordHash) {
                closePasswordModal();
                openEditor();
            } else {
                showAlert("비밀번호가 틀렸습니다.", true);
                passwordForm.reset();
            }
        });

        function openEditor() {
            populateEditorPostList();
            editorModal.classList.remove('hidden');
            if (posts.length > 0) {
                const firstPostId = [...posts].sort((a,b) => b.isPinned - a.isPinned)[0].id;
                loadPostInEditor(firstPostId);
            } else {
                startNewPost();
            }
        }

        function closeEditor() {
            editorModal.classList.add('hidden');
            currentEditingPostId = null;
            isCreatingNewPost = false;
        }
        editorCloseBtn.addEventListener('click', closeEditor);
        editorCancelBtn.addEventListener('click', closeEditor);

        function populateEditorPostList() {
            editorPostList.innerHTML = '';
            const ul = document.createElement('ul');
            ul.className = 'space-y-1';
            const sortedPosts = [...posts].sort((a, b) => b.isPinned - a.isPinned);
            sortedPosts.forEach(post => {
                const li = document.createElement('li');
                li.innerHTML = `<a href="#" data-id="${post.id}" class="editor-post-link block p-2 rounded-md hover:bg-gray-200 truncate">${post.title}</a>`;
                ul.appendChild(li);
            });
            editorPostList.appendChild(ul);
        }
        
        editorPostList.addEventListener('click', (e) => {
            if (e.target.closest('.editor-post-link')) {
                e.preventDefault();
                const link = e.target.closest('.editor-post-link');
                const postId = parseInt(link.dataset.id);
                loadPostInEditor(postId);
            }
        });

        function loadPostInEditor(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;
            
            isCreatingNewPost = false;
            editorDeleteBtn.disabled = false;
            currentEditingPostId = postId;
            editorTitle.value = post.title;
            editorDate.value = post.date;
            editorPinToggle.checked = post.isPinned;
            editorContent.innerHTML = post.content;
            editorSaveBtn.textContent = "수정 완료";
            
            document.querySelectorAll('.editor-post-link').forEach(link => {
                link.classList.toggle('bg-gray-300', parseInt(link.dataset.id) === postId);
                link.classList.toggle('font-semibold', parseInt(link.dataset.id) === postId);
            });
        }

        addNewPostBtn.addEventListener('click', startNewPost);

        function startNewPost() {
            isCreatingNewPost = true;
            editorDeleteBtn.disabled = true;
            currentEditingPostId = null;
            editorTitle.value = "새로운 게시물";
            editorDate.valueAsDate = new Date();
            editorPinToggle.checked = false;
            editorContent.innerHTML = "<p>여기에 내용을 입력하세요.</p>";
            editorSaveBtn.textContent = "게시물 발행";
            
            document.querySelectorAll('.editor-post-link').forEach(link => {
                link.classList.remove('bg-gray-300', 'font-semibold');
            });
            editorTitle.focus();
        }

        editorDeleteBtn.addEventListener('click', () => {
            if (isCreatingNewPost || currentEditingPostId === null) return;
            const postToDelete = posts.find(p => p.id === currentEditingPostId);
            if (postToDelete) {
                deleteConfirmMessage.textContent = `'${postToDelete.title}' 게시물을 정말 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.`;
                deleteConfirmModal.classList.remove('hidden');
            }
        });

        deleteCancelBtn.addEventListener('click', () => {
            deleteConfirmModal.classList.add('hidden');
        });

        deleteConfirmBtn.addEventListener('click', () => {
            if (currentEditingPostId === null) return;
            posts = posts.filter(p => p.id !== currentEditingPostId);
            deleteConfirmModal.classList.add('hidden');
            showAlert("게시물이 삭제되었습니다.");
            
            renderBlog();
            populateEditorPostList();
            startNewPost();
        });

        editorSaveBtn.addEventListener('click', () => {
            let savedPostId;
            if (isCreatingNewPost) {
                const newPost = {
                    id: Date.now(),
                    title: editorTitle.value,
                    date: editorDate.value,
                    content: editorContent.innerHTML,
                    isPinned: editorPinToggle.checked
                };
                posts.unshift(newPost);
                savedPostId = newPost.id;
                showAlert("새 게시물이 발행되었습니다.");
            } else {
                if (currentEditingPostId === null) return;
                const postIndex = posts.findIndex(p => p.id === currentEditingPostId);
                if (postIndex === -1) return;
                posts[postIndex].title = editorTitle.value;
                posts[postIndex].date = editorDate.value;
                posts[postIndex].content = editorContent.innerHTML;
                posts[postIndex].isPinned = editorPinToggle.checked;
                savedPostId = currentEditingPostId;
                showAlert("게시물이 성공적으로 수정되었습니다.");
            }
            
            renderBlog();
            populateEditorPostList();
            loadPostInEditor(savedPostId);
        });

        // --- 초기화 ---
        renderBlog();
    });
    </script>
</body>
</html>
